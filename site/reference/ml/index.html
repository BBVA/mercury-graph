
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../core/">
      
      
        <link rel="next" href="../embeddings/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.45">
    
    
      
        <title>mercury.graph.ml - mercury-graph</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mercury.graph.ml.LouvainCommunities" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="mercury-graph" class="md-header__button md-logo" aria-label="mercury-graph" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mercury-graph
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              mercury.graph.ml
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/BBVA/mercury-graph/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    mercury-graph
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="mercury-graph" class="md-nav__button md-logo" aria-label="mercury-graph" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg>

    </a>
    mercury-graph
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BBVA/mercury-graph/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    mercury-graph
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mercury.graph.core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    mercury.graph.ml
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    mercury.graph.ml
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.LouvainCommunities" class="md-nav__link">
    <span class="md-ellipsis">
      LouvainCommunities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LouvainCommunities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.LouvainCommunities.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.SparkRandomWalker" class="md-nav__link">
    <span class="md-ellipsis">
      SparkRandomWalker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SparkRandomWalker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.SparkRandomWalker.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.SparkSpreadingActivation" class="md-nav__link">
    <span class="md-ellipsis">
      SparkSpreadingActivation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SparkSpreadingActivation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.SparkSpreadingActivation.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.SpectralClustering" class="md-nav__link">
    <span class="md-ellipsis">
      SpectralClustering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpectralClustering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.SpectralClustering.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.Transition" class="md-nav__link">
    <span class="md-ellipsis">
      Transition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.Transition.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.Transition.to_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      to_pandas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../embeddings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mercury.graph.embeddings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../viz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mercury.graph.viz
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.LouvainCommunities" class="md-nav__link">
    <span class="md-ellipsis">
      LouvainCommunities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LouvainCommunities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.LouvainCommunities.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.SparkRandomWalker" class="md-nav__link">
    <span class="md-ellipsis">
      SparkRandomWalker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SparkRandomWalker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.SparkRandomWalker.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.SparkSpreadingActivation" class="md-nav__link">
    <span class="md-ellipsis">
      SparkSpreadingActivation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SparkSpreadingActivation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.SparkSpreadingActivation.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.SpectralClustering" class="md-nav__link">
    <span class="md-ellipsis">
      SpectralClustering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpectralClustering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.SpectralClustering.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mercury.graph.ml.Transition" class="md-nav__link">
    <span class="md-ellipsis">
      Transition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.Transition.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.graph.ml.Transition.to_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      to_pandas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>mercury.graph.ml</h1>

<div class="doc doc-object doc-class">



<h2 id="mercury.graph.ml.LouvainCommunities" class="doc doc-heading">
              <code class=" language-python"><span class="n">mercury</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">LouvainCommunities</span><span class="p">(</span><span class="n">min_modularity_gain</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_pass</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">all_partitions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="mercury.graph.core.base.BaseClass">BaseClass</span></code></p>


        <p>Class that defines the functions that run a PySpark implementation of the 
Louvain algorithm to find the partition that maximizes the modularity of an 
undirected graph (as in <sup id="mercury.graph.ml.LouvainCommunities--fnref:1"><a class="footnote-ref" href="#mercury.graph.ml.LouvainCommunities--fn:1">1</a></sup>).</p>
<p>This version of the algorithm differs from <sup id="mercury.graph.ml.LouvainCommunities--fnref2:1"><a class="footnote-ref" href="#mercury.graph.ml.LouvainCommunities--fn:1">1</a></sup> in that the reassignment of
nodes to new communities is calculated in parallel, not sequentially. That is,
all nodes are reassigned at the same time and conflicts (i.e., 1 -&gt; C2 and
2 -&gt; C1) are resolved with a simple tie-breaking rule. This version also
introduces the resolution parameter <em>gamma</em>, as in <sup id="mercury.graph.ml.LouvainCommunities--fnref:2"><a class="footnote-ref" href="#mercury.graph.ml.LouvainCommunities--fn:2">2</a></sup>.</p>
<p>Contributed by Arturo Soberon Cedillo, Jose Antonio Guzman Vazquez and 
Isaac Dodanim Hernandez Garcia.</p>
<div class="footnote">
<hr />
<ol>
<li id="mercury.graph.ml.LouvainCommunities--fn:1">
<p>Blondel V D, Guillaume J-L, Lambiotte R and Lefebvre E (2008). Fast
unfolding of communities in large networks. Journal of Statistical
Mechanics: Theory and Experiment, 2008.
<a href="https://doi.org/10.1088/1742-5468/2008/10/p10008">https://doi.org/10.1088/1742-5468/2008/10/p10008</a>&#160;<a class="footnote-backref" href="#mercury.graph.ml.LouvainCommunities--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#mercury.graph.ml.LouvainCommunities--fnref2:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="mercury.graph.ml.LouvainCommunities--fn:2">
<p>Aynaud T, Blondel V D, Guillaume J-L and Lambiotte R (2013). Multilevel
local optimization of modularity. Graph Partitioning (315--345), 2013.&#160;<a class="footnote-backref" href="#mercury.graph.ml.LouvainCommunities--fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>min_modularity_gain</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Modularity gain threshold between each pass. The algorithm 
stops if the gain in modularity between the current pass
and the previous one is less than the given threshold.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_pass</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of passes.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_iter</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations within each pass.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resolution</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The resolution parameter <em>gamma</em>. Its value
must be greater or equal to zero. If resolution is less than 1,
modularity favors larger communities, while values greater than 1
favor smaller communities.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>all_partitions</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the function will return all the partitions found at each
step of the algorithm (i.e., pass0, pass1, pass2, ..., pass20). If
False, only the last (and best) partition will be returned.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, print progress information during the Louvain algorithm
execution. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/graph/ml/louvain.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">min_modularity_gain</span><span class="o">=</span><span class="mf">1e-03</span><span class="p">,</span>
    <span class="n">max_pass</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">all_partitions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_modularity_gain</span> <span class="o">=</span> <span class="n">min_modularity_gain</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_pass</span> <span class="o">=</span> <span class="n">max_pass</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span> <span class="o">=</span> <span class="n">max_iter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_partitions</span> <span class="o">=</span> <span class="n">all_partitions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="c1"># Check resolution</span>
    <span class="k">if</span> <span class="n">resolution</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">exceptionMsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Resolution value is </span><span class="si">{</span><span class="n">resolution</span><span class="si">}</span><span class="s2"> and cannot be &lt; 0.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">exceptionMsg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mercury.graph.ml.LouvainCommunities.fit" class="doc doc-heading">
            <code class=" language-python"><span class="n">fit</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>g</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.graph.core.Graph" href="../core/#mercury.graph.core.Graph">Graph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mercury graph structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>self</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted self (or raises an error).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/graph/ml/louvain.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        g (Graph): A mercury graph structure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (self): Fitted self (or raises an error).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">graphframe</span><span class="o">.</span><span class="n">edges</span>

    <span class="c1"># Verify edges input</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_verify_data</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span>
        <span class="n">expected_cols_grouping</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">],</span>
        <span class="n">expected_cols_others</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Init dataframe to be returned</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">edges</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;src as id&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">unionByName</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;dst as id&quot;</span><span class="p">))</span>
        <span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
        <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;pass0&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">row_number</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">Window</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">()</span>

    <span class="c1"># Convert edges to anonymized src&#39;s and dst&#39;s</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">edges</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;src as src0&quot;</span><span class="p">,</span> <span class="s2">&quot;dst as dst0&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">ret</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;id as src0&quot;</span><span class="p">,</span> <span class="s2">&quot;pass0 as src&quot;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;src0&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">ret</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;id as dst0&quot;</span><span class="p">,</span> <span class="s2">&quot;pass0 as dst&quot;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;dst0&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">()</span>

    <span class="c1"># Calculate m and initialize modularity</span>
    <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_m</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
    <span class="n">modularity0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>

    <span class="c1"># Begin pass</span>
    <span class="n">canPass</span><span class="p">,</span> <span class="n">_pass</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">canPass</span><span class="p">:</span>

        <span class="c1"># Declare naive partition</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">edges</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;src as id&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unionByName</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;dst as id&quot;</span><span class="p">))</span>
            <span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
            <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c1"># Begin iterations within pass</span>
        <span class="n">canIter</span><span class="p">,</span> <span class="n">_iter</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">0</span>
        <span class="c1"># Carry reference to previously cached p2 to call unpersist()</span>
        <span class="n">prev_p2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="n">canIter</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">_iter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="c1"># Print progress</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting Pass </span><span class="si">{</span><span class="n">_pass</span><span class="si">}</span><span class="s2"> Iteration </span><span class="si">{</span><span class="n">_iter</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

            <span class="c1"># Create new partition and check if movements were made</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reassign_all</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
            <span class="c1"># Break complex lineage caused by loops first</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="n">p2</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">()</span>
            <span class="n">p2</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>

            <span class="n">canIter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;cx != cj&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">canIter</span><span class="p">:</span>
                <span class="n">p1</span> <span class="o">=</span> <span class="n">p2</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;cj as c&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prev_p2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prev_p2</span><span class="o">.</span><span class="n">unpersist</span><span class="p">()</span>
            <span class="n">prev_p2</span> <span class="o">=</span> <span class="n">p2</span>
            <span class="n">_iter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Calculate new modularity and update pass counter</span>
        <span class="n">modularity1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_modularity</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span> <span class="n">partition</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>

        <span class="c1"># Declare stopping criterion and update old modularity</span>
        <span class="n">canPass</span> <span class="o">=</span> <span class="p">(</span><span class="n">modularity1</span> <span class="o">-</span> <span class="n">modularity0</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_modularity_gain</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">_pass</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pass</span>
        <span class="p">)</span>
        <span class="n">modularity0</span> <span class="o">=</span> <span class="n">modularity1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">modularity_</span> <span class="o">=</span> <span class="n">modularity0</span>

        <span class="c1"># Update ret and compress graph</span>
        <span class="k">if</span> <span class="n">canPass</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">other</span><span class="o">=</span><span class="n">p1</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;id as pass</span><span class="si">{</span><span class="n">_pass</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;c as pass</span><span class="si">{</span><span class="n">_pass</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
                <span class="n">on</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pass</span><span class="si">{</span><span class="n">_pass</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">()</span>

            <span class="n">edges</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_label_edges</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
                <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;cSrc&quot;</span><span class="p">,</span> <span class="s2">&quot;cDst&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;cSrc&quot;</span><span class="p">,</span> <span class="s2">&quot;cDst&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;weight&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;weight&quot;</span><span class="p">))</span>
                <span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;cSrc as src&quot;</span><span class="p">,</span> <span class="s2">&quot;cDst as dst&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">()</span>

        <span class="n">prev_p2</span><span class="o">.</span><span class="n">unpersist</span><span class="p">()</span>
        <span class="n">_pass</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Return final dataframe with sorted columns</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_partitions</span><span class="p">:</span>

        <span class="c1"># Return sorted columns</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sort_passes</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>

    <span class="c1"># Return final dataframe with id &amp; community</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_pass</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="s2">&quot;id as node_id&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_last</span><span class="si">}</span><span class="s2"> as cluster&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">labels_</span> <span class="o">=</span> <span class="n">ret</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mercury.graph.ml.SparkRandomWalker" class="doc doc-heading">
              <code class=" language-python"><span class="n">mercury</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">SparkRandomWalker</span><span class="p">(</span><span class="n">num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_sampling_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="mercury.graph.core.base.BaseClass">BaseClass</span></code></p>


        <p>Class to perform random walks from a specific source_id node within a given Graph</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_epochs</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of epochs. This is the total number of steps the iteration goes through.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This forces caching the random walks computed so far and breaks planning each time this number of epochs
is reached. The default value is a high number to avoid this entering at all. In really large jobs, you may want to
set this parameter to avoid possible overflows even if it can add some extra time to the process. Note that with a high
number of epochs and nodes resource requirements for the active part of your random walks can be high. This allows to
"cache a continue" so to say.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_sampling_edges</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>by setting this parameter you can limit at each timestep the number of new paths opened from each node.
This is useful when the graph contains nodes with very high out-degree, where running the algorithm several epochs is
not feasible. When using this parameter, the graph will consider only at most <code>edge_sampling</code> outgoing edges at each
epoch for each path. If the last node of the path contains more than <code>edge_sampling</code> the selected edges are sampled
using its weight.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/graph/ml/spark_randomwalker.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_sampling_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to perform random walks from a specific source_id node within a given Graph</span>

<span class="sd">    Args:</span>
<span class="sd">        num_epochs (int): Number of epochs. This is the total number of steps the iteration goes through.</span>
<span class="sd">        batch_size (int): This forces caching the random walks computed so far and breaks planning each time this number of epochs</span>
<span class="sd">            is reached. The default value is a high number to avoid this entering at all. In really large jobs, you may want to</span>
<span class="sd">            set this parameter to avoid possible overflows even if it can add some extra time to the process. Note that with a high</span>
<span class="sd">            number of epochs and nodes resource requirements for the active part of your random walks can be high. This allows to</span>
<span class="sd">            &quot;cache a continue&quot; so to say.</span>
<span class="sd">        n_sampling_edges (int): by setting this parameter you can limit at each timestep the number of new paths opened from each node.</span>
<span class="sd">            This is useful when the graph contains nodes with very high out-degree, where running the algorithm several epochs is</span>
<span class="sd">            not feasible. When using this parameter, the graph will consider only at most `edge_sampling` outgoing edges at each</span>
<span class="sd">            epoch for each path. If the last node of the path contains more than `edge_sampling` the selected edges are sampled</span>
<span class="sd">            using its weight.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_epochs</span> <span class="o">=</span> <span class="n">num_epochs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_sampling_edges</span> <span class="o">=</span> <span class="n">n_sampling_edges</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mercury.graph.ml.SparkRandomWalker.fit" class="doc doc-heading">
            <code class=" language-python"><span class="n">fit</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">source_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform random walks from a specific source_id node within a given Graph</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>G</code>
            </td>
            <td>
                  <code>mercury.graph Graph asset</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>mercury.graph</code> Graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_id</code>
            </td>
            <td>
                  <code>int / str / list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the source vertex or list for vertices to start the random walks.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>self</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted self (or raises an error)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Attribute <code>paths_</code> contains a Spark Dataframe with a columns <code>random_walks</code> containing an array of the elements
of the path walked and another column with the corresponding weights. The weights represent the probability of
following that specific path starting from source_id.</p>

            <details class="quote">
              <summary>Source code in <code>mercury/graph/ml/spark_randomwalker.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform random walks from a specific source_id node within a given Graph</span>

<span class="sd">    Args:</span>
<span class="sd">        G (mercury.graph Graph asset): A `mercury.graph` Graph</span>
<span class="sd">        source_id (int/str/list): the source vertex or list for vertices to start the random walks.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (self): Fitted self (or raises an error)</span>

<span class="sd">    Attribute `paths_` contains a Spark Dataframe with a columns `random_walks` containing an array of the elements</span>
<span class="sd">    of the path walked and another column with the corresponding weights. The weights represent the probability of</span>
<span class="sd">    following that specific path starting from source_id.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">paths_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_rw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">source_id</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mercury.graph.ml.SparkSpreadingActivation" class="doc doc-heading">
              <code class=" language-python"><span class="n">mercury</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">SparkSpreadingActivation</span><span class="p">(</span><span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;influence&#39;</span><span class="p">,</span> <span class="n">spreading_factor</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">transfer_function</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">influenced_by</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="mercury.graph.core.base.BaseClass">BaseClass</span></code></p>


        <p>This class is a model that represents a word-of-mouth scenario where a node influences his neighbors, from where
the influence spreads to other neighbors, and so on.</p>
<p>At the end of the diffusion process, we inspect the amount of influence received by each node. Using a
threshold-based technique, a node that is currently not influenced can be declared to be a potential future one,
based on the influence that has been accumulated.</p>
<p>The diffusion model is based on Spreading Activation (SPA) techniques proposed in cognitive psychology
and later used for trust metric computations. For more details, please see paper entitled 
<a href="https://pdfs.semanticscholar.org/3275/3d80adb5ec2d4a974b5d1a872e2c957b263b.pdf">"Social Ties and their Relevance to Churn in Mobile Telecom Networks"</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>attribute</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name which will store the amount of influence spread</p>
              </div>
            </td>
            <td>
                  <code>&#39;influence&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>spreading_factor</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Percentage of influence to distribute. Low values favor influence proximity to the source of injection,
while high values allow the influence to also reach nodes which are further away. It must be a value in the range (0,1).
Default value is 0.2</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transfer_function</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Allowed values: "weighted" or "unweighted".
Once a node decides what fraction of energy to distribute, the next step is to decide what fraction of the energy is transferred
to each neighbor. This is controlled by the Transfer Function. If "weighted" then the energy distributed along the directed
edge <X,Y> depends on its relatively weight compared to the sum of weights of all outgoing edges of X. If "unweighted", then
the energy distributed along the edge <X,Y> is independent of its relatively weight.</p>
              </div>
            </td>
            <td>
                  <code>&#39;weighted&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to perform</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>influenced_by</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, and extra column "influenced_by" is calculated which contains the seed nodes that have spread some
influence to a given node. When True, the ids of the nodes cannot contain commas ",". Note that seed_nodes will have at least
their own (remaining) influence</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/graph/ml/spark_spreadactivation.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;influence&quot;</span><span class="p">,</span>
    <span class="n">spreading_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">transfer_function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;weighted&quot;</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">influenced_by</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="n">attribute</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spreading_factor</span> <span class="o">=</span> <span class="n">spreading_factor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transfer_function</span> <span class="o">=</span> <span class="n">transfer_function</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">influenced_by</span> <span class="o">=</span> <span class="n">influenced_by</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mercury.graph.ml.SparkSpreadingActivation.fit" class="doc doc-heading">
            <code class=" language-python"><span class="n">fit</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">seed_nodes</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform all iterations of spread_activation</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>g</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.graph.core.Graph" href="../core/#mercury.graph.core.Graph">Graph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>mercury.graph</code> Graph object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed_nodes</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>, <span title="pyspark.sql.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Collection of nodes that are the "seed" or are the source to spread
the influence. It must be pyspark dataframe with column 'id' or python list</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>self</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted self</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/graph/ml/spark_spreadactivation.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">g</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
    <span class="n">seed_nodes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">,</span> <span class="s2">&quot;pyspark.sql.DataFrame&quot;</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform all iterations of spread_activation</span>

<span class="sd">    Args:</span>
<span class="sd">        g (mercury.graph.core.Graph): A `mercury.graph` Graph object.</span>
<span class="sd">        seed_nodes (Union[List, pyspark.sql.DataFrame]): Collection of nodes that are the &quot;seed&quot; or are the source to spread</span>
<span class="sd">            the influence. It must be pyspark dataframe with column &#39;id&#39; or python list</span>

<span class="sd">    Returns:</span>
<span class="sd">        (self): Fitted self</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set seed nodes which are the source of influence</span>
    <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_seed_nodes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">seed_nodes</span><span class="p">)</span>

    <span class="c1"># Compute degrees</span>
    <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_degrees</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="c1"># Number of iterations specified for spread activation</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spread_activation_step</span><span class="p">(</span>
            <span class="n">g</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Graph with updated attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fitted_graph_</span> <span class="o">=</span> <span class="n">g</span>
    <span class="c1"># Influences as DataFrame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">influences_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitted_graph_</span><span class="o">.</span><span class="n">nodes_as_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;influence&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mercury.graph.ml.SpectralClustering" class="doc doc-heading">
              <code class=" language-python"><span class="n">mercury</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">SpectralClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;networkx&#39;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="mercury.graph.core.base.BaseClass">BaseClass</span></code></p>


        <p>Implementation of the spectral clustering algorithm which detect communities inside a graph.</p>
<p>Contributed by Gibran Gabriel Otazo Sanchez.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_clusters</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of clusters that you want to detect.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for reproducibility</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Calculation mode. Pass 'networkx' for using pandas + networkx or
        'spark' for spark + graphframes</p>
              </div>
            </td>
            <td>
                  <code>&#39;networkx&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_iterations</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Max iterations parameter (only used if mode==spark)</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/graph/ml/spectral.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;networkx&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;networkx&quot;</span><span class="p">,</span> <span class="s2">&quot;spark&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: Mode must be either &#39;networkx&#39; or &#39;spark&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mercury.graph.ml.SpectralClustering.fit" class="doc doc-heading">
            <code class=" language-python"><span class="n">fit</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Find the optimal clusters of a given graph. The function returns nothing, but saves the clusters and
the modularity in the object self.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.graph.core.Graph" href="../core/#mercury.graph.core.Graph">Graph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mercury graph structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>self</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted self (or raises an error)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/graph/ml/spectral.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the optimal clusters of a given graph. The function returns nothing, but saves the clusters and</span>
<span class="sd">    the modularity in the object self.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph (Graph): A mercury graph structure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (self): Fitted self (or raises an error)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;networkx&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_networkx</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_spark</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mercury.graph.ml.Transition" class="doc doc-heading">
              <code class=" language-python"><span class="n">mercury</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">Transition</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="mercury.graph.core.base.BaseClass">BaseClass</span></code></p>


        <p>Create an interface class to manage the adjacency matrix of a directed graph as a transition matrix.
This enables computing distributions of probabilities over the nodes after a given number of iterations.</p>






                  <details class="quote">
                    <summary>Source code in <code>mercury/graph/ml/transition.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fitted_graph_</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mercury.graph.ml.Transition.fit" class="doc doc-heading">
            <code class=" language-python"><span class="n">fit</span><span class="p">(</span><span class="n">G</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts the adjacency matrix into a transition matrix. Transition matrices are used to compute the distribution of probability
of being in each of the nodes (or states) of a directed graph (or Markov process). The distribution for state s is:</p>
<ul>
<li><span class="arithmatex">\(s_t = T*s_{t-1}\)</span></li>
</ul>
<p>Where:</p>
<p>T is the transition matrix. After calling.fit(), the adjacency matrix is the transition matrix. You can use .to_pandas() to see it.
<span class="arithmatex">\(s_{t-1}\)</span> is the previous state.</p>
<p>What .fit() does is scaling the non-zero rows to make them sum 1 as they are probability distributions and make the zero rows
recurrent states. A recurrent state is a final state, a state whose next state is itself.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>G</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.graph.core.Graph" href="../core/#mercury.graph.core.Graph">Graph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>mercury.graph</code> Graph.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>self</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted self (or raises an error).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>If created using NetworkX directly, the name of the weight must be 'weight' and must be positive. The recommended way
to create the graph is using .set_row() which will always name the weight as 'weight' but does not check the value.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>mercury/graph/ml/transition.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G</span><span class="p">:</span> <span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the adjacency matrix into a transition matrix. Transition matrices are used to compute the distribution of probability</span>
<span class="sd">    of being in each of the nodes (or states) of a directed graph (or Markov process). The distribution for state s is:</span>

<span class="sd">    * $s_t = T*s_{t-1}$</span>

<span class="sd">    Where:</span>

<span class="sd">    T is the transition matrix. After calling.fit(), the adjacency matrix is the transition matrix. You can use .to_pandas() to see it.</span>
<span class="sd">    $s_{t-1}$ is the previous state.</span>

<span class="sd">    What .fit() does is scaling the non-zero rows to make them sum 1 as they are probability distributions and make the zero rows</span>
<span class="sd">    recurrent states. A recurrent state is a final state, a state whose next state is itself.</span>

<span class="sd">    Args:</span>
<span class="sd">        G (Graph): A `mercury.graph` Graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (self): Fitted self (or raises an error).</span>

<span class="sd">    Note:</span>
<span class="sd">        If created using NetworkX directly, the name of the weight must be &#39;weight&#39; and must be positive. The recommended way</span>
<span class="sd">        to create the graph is using .set_row() which will always name the weight as &#39;weight&#39; but does not check the value.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">networkx</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
    <span class="n">adj_m</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">networkx</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">adj_m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">adj_m</span><span class="p">[[</span><span class="n">i</span><span class="p">],</span> <span class="p">:]</span>
            <span class="n">tot</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">tot</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">row</span> <span class="o">/</span> <span class="n">tot</span>

            <span class="n">adj_m</span><span class="p">[[</span><span class="n">i</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">row</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">adj_m</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fitted_graph_</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_adjacency</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">))</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mercury.graph.ml.Transition.to_pandas" class="doc doc-heading">
            <code class=" language-python"><span class="n">to_pandas</span><span class="p">(</span><span class="n">num_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the adjacency (which is the transition matrix after <code>fit()</code> was called) for a given number of iterations as a pandas
dataframe with labeled rows and columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_iterations</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you want to compute the matrix for a different number of iterations, k, you can use this argument to
raise the matrix to any non negative integer, since <span class="arithmatex">\(s_{t+k} = T^k*s_t\)</span></p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The transition matrix for num_iterations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This method does not automatically call <code>fit()</code>. This allows inspecting the adjacency matrix as a pandas dataframe.
The result of computing num_iterations will not make sense if <code>fit()</code> has not been called before <code>to_pandas()</code>.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>mercury/graph/ml/transition.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the adjacency (which is the transition matrix after `fit()` was called) for a given number of iterations as a pandas</span>
<span class="sd">    dataframe with labeled rows and columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_iterations (int): If you want to compute the matrix for a different number of iterations, k, you can use this argument to</span>
<span class="sd">            raise the matrix to any non negative integer, since $s_{t+k} = T^k*s_t$</span>

<span class="sd">    Returns:</span>
<span class="sd">        (pd.DataFrame): The transition matrix for num_iterations.</span>

<span class="sd">    Note:</span>
<span class="sd">        This method does not automatically call `fit()`. This allows inspecting the adjacency matrix as a pandas dataframe.</span>
<span class="sd">        The result of computing num_iterations will not make sense if `fit()` has not been called before `to_pandas()`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitted_graph_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: fit() must be called first.&quot;</span><span class="p">)</span>

    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitted_graph_</span><span class="o">.</span><span class="n">networkx</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
    <span class="n">adj_m</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitted_graph_</span><span class="o">.</span><span class="n">networkx</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;weight&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">num_iterations</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">adj_m</span> <span class="o">=</span> <span class="n">matrix_power</span><span class="p">(</span><span class="n">adj_m</span><span class="p">,</span> <span class="n">num_iterations</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">adj_m</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://es.linkedin.com/showcase/bbva-ai-factory/" target="_blank" rel="noopener" title="es.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bbva_aifactory" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["tabs", "navigation.indexes", "navigation.path", "navigation.expand", "search.suggest", "search.highlight", "search.share", "content.footnote.tooltips"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>